---
layout: post
title: "Social Malware: Market and Analysis"
permalink: /2020/social-malware/market-and-analysis/
description: "This will be a high-level piece analyzing why someone would write malware to generate seemingly-innocuous 'likes' instead of attempting to steal money or resources from the infected people. Content development in progress."
date: 2020-10-19 00:00:00
tags:
- extension
- chrome
published: false
---


## Analysis

The key, of course, is to have as many browsers infected as possible, and generate likes with them frequently. Leaving this running for a while, I observed that an idle system is used to like content on Instagram as frequently as once every one-and-a-half minutes:

![WebSocket events, annotated, with heartbeats removed.](/2020/social-malware/inside-a-malicious-extension/websocket-timing.png)

At an estimate of $0.01/like, 30 likes/hour, and 8 hours active/day ([thanks, COVID](https://www.youtube.com/watch?v=TK3QFL9akFg)), that's a cool $2.4/day/browser, doing activity which would be unnoticed by many users and can run on any system that can run Chrome.


## Notes

Likes include risk, but less risk than follows or other user-apparent content

Instagram should detect this based on traffic

Determining who is buying these resources is Sisyphean, which is mad props to the author.


## Security Recommendations

While it's not the most potent or original malware ever seen, it serves as an important reminder to be diligent and thoughtful about how to manage our safety online. Most everyone who has read through this post probably knows these, so if nothing else, *tell your friends* so they can get a deeper understanding of how to stay secure.

- **Just because it's on the Chrome Web Store, doesn't mean it's safe.** This malicious extension isn't an [isolated incident](https://threatpost.com/500-malicious-chrome-extensions-millions/152918/). I would love to live in a world where I could simply say "Google Trust & Safety took care of this concern for you," but we're not there yet, and we probably never will be able to say so with 100% certainty. This is the price we pay for diverse application marketplaces - for the Chrome Web Store to feature eighteen different "user agent switcher" extensions, there will necessarily be less per-app security supervision than if Google only allowed three. Therefore, users should always be thoughtful and careful when downloading applications, even off company-run app stores.
- **Don't install extensions from untrusted authors.** [Downloads](https://www.theregister.com/2020/05/28/chrome_web_store_fraud/) and [reviews](https://www.quora.com/Should-I-boost-my-Chrome-extension-user-base-by-buying-users-and-reviews) can be bought - reputation can't (...[as cheaply](https://www.caoc.org/?pg=facts)). What do people say about the author of the extension you're about to download? Is it a well-known company? Can you make sure it's that company's extension, and not someone pretending to be that company?
- **Be extra cautious when installing extensions which can 'read and change all your data on the websites you visit.' (or similar)** Extensions that request this permission from your browser can do nearly anything, including impersonate your actions on the sites you use (and sites you don't), like UAS does. ♪ "Anything you can do I can do better... without your knowledge" ♪ isn't quite musical, but it is [pretty close](https://security.stackexchange.com/questions/15259/worst-case-scenario-what-can-a-chrome-extension-do-with-your-data-on-all-websi) to the truth.
- **If you see something, say something.** When something happens on your computer that you didn't expect - such as likes, posts, emails, or other things appearing which you're fairly sure you didn't create - phone a technologically-adept friend. If you're at work, alert your workplace's IT or Information Security groups. Antimalware will never be perfect, and this extension slips by [61/61](https://www.virustotal.com/gui/file/d5a988742418a06ba6c0649e6ace78eb4bcd061f2222f1a9cc1d97492763cd09/detection) antimalware programs on VirusTotal. Even layered solutions could miss it, and running `www.useragentswitch.com` through some [threat-blocking DNS providers](https://www.ipvoid.com/dns-reputation/), only CleanBrowsing picked it up, and that's likely because it's an [unusually new domain](/2020/social-malware/inside-a-malicious-extension/whois-useragentswitch.com.txt).

There is no "silver bullet" solution to all security issues, but being thoughtful and practicing good security hygiene will make a huge difference.

Stay safe and be well.